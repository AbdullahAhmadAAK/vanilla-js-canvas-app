<html>

<body>
  <canvas width="500" height="500" id="canvas"></canvas>

  <button id="blue-button">Blue</button>
  <button id="red-button">Red</button>

  <script>
    let previousX = 0
    let previousY = 0

    const canvas = document.getElementById('canvas')
    const ctx = canvas.getContext('2d')

    const blueButton = document.getElementById('blue-button')
    blueButton.addEventListener('click', () => {
      penColor = 'blue'
    })

    const redButton = document.getElementById('red-button')
    redButton.addEventListener('click', () => {
      penColor = 'red'
    })

    let penColor = 'red'
    let penWidth = 5

    // Your code here ðŸ‘‡
    const drawPixels = (x, y) => {
      ctx.beginPath()

      ctx.arc(x, y, penWidth, 2 * Math.PI, false)
      ctx.fillStyle = penColor

      ctx.fill()
    }

    // const erasePixelsTest = (x, y) => {
    //   ctx.beginPath()

    //   ctx.arc(x, y, penWidth, 2 * Math.PI, false)
    //   ctx.fillStyle = penColor

    //   ctx.fill()
    // }

    const erasePixels = (x, y) => {
      ctx.save()

      ctx.beginPath()
      ctx.arc(x, y, penWidth, 2 * Math.PI, false)

      ctx.globalCompositeOperation = 'destination-out'

      ctx.fillStyle = 'white'
      ctx.fill()
      ctx.restore()
    }


    const drawLine = (x, y) => {
      ctx.beginPath()
      ctx.moveTo(previousX, previousY)
      ctx.lineTo(x, y)

      ctx.strokeStyle = penColor
      ctx.lineWidth = penWidth
      ctx.lineCap = 'round'

      ctx.stroke()
    }

    const eraseLine = (x, y) => {
      ctx.save()

      ctx.beginPath()
      ctx.moveTo(previousX, previousY)
      ctx.lineTo(x, y)

      ctx.globalCompositeOperation = 'destination-out'

      ctx.strokeStyle = 'white'
      ctx.lineWidth = penWidth
      ctx.lineCap = 'round'

      ctx.stroke()
      ctx.restore()
    }



    // End of your code ðŸ‘†

    const render = (e) => {
      const x = e.offsetX
      const y = e.offsetY

      console.log(`Drawing at (${x}, ${y})`)

      if (e.shiftKey) {
        // erasePixels(x, y)
        eraseLine(x, y)
      } else {
        // drawPixels(x, y)
        drawLine(x, y)
      }

      previousX = x
      previousY = y
    }


    canvas.addEventListener('mousedown', (e) => {
      previousX = e.offsetX
      previousY = e.offsetY

      canvas.addEventListener('mousemove', render)

      canvas.addEventListener('mouseup', () => {
        canvas.removeEventListener('mousemove', render)
      })
    })

  </script>
</body>

</html>